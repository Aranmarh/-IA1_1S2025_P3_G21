<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Laberinto 3D</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- Cargamos SweetAlert2 -->
  <style>
    body { margin: 0; overflow: hidden; }
    canvas { width: 100%; height: 100%; }
    .botonInicio {
      background-color: #00bfa5;
      color: white;
      border: none;
      padding: 20px 50px;
      font-size: 28px;
      font-weight: bold;
      border-radius: 30px;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.2s;
    }

    html {
    overflow-y: scroll; /* Fuerza siempre mostrar barra de desplazamiento vertical */
  }

    .botonInicio:hover {
      background-color: #009688;
      transform: scale(1.1);
    }
  </style>
</head>

<body>
    <div style="position: absolute; top: 20px; width: 100%; text-align: center; z-index: 1;">
        <button class="botonInicio" onclick="loginAdmin()">Nuevo laberinto</button>
        <button  class="botonInicio" onclick="irLaberinto()">Home</button>
    </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r83/three.js"></script>
  <script>
    // Tu JSON de laberinto
    const laberinto = {
      "ancho": 5,
      "alto": 5,
      "inicio": [0, 0],
      "fin": [4, 4],
      "paredes": [
        [0, 4],
        [1, 0],
        [1, 1],
        [1, 2],
        [2, 4],
        [3, 1],
        [3, 2],
        [3, 3],
        [3, 4]
      ]
    };

    // Configuración básica de Three.js
    let scene = new THREE.Scene();
    
    let camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    let renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Materiales
    const materialPared = new THREE.MeshBasicMaterial({ color: 0x333333 }); // Pared (gris oscuro)
    const materialInicio = new THREE.MeshBasicMaterial({ color: 0x00ff00 }); // Inicio (verde)
    const materialFin = new THREE.MeshBasicMaterial({ color: 0xff0000 });   // Fin (rojo)
    const materialPiso = new THREE.MeshBasicMaterial({ color: 0x888888  });   // Piso normal (gris claro)

    // bordes
    
    const cubos = [];

    const tamañoCubo = 1; // Cada cubo mide 1x1x1

    // fondo de la imagen
    const loader = new THREE.TextureLoader();
    loader.load('https://st4.depositphotos.com/2000583/38977/i/450/depositphotos_389772856-stock-photo-tropical-leaves-background-copy-space.jpg', function(texture) {
    scene.background = texture;
    });

    // Función para verificar si una posición es pared
    function esPared(x, y) {
      return laberinto.paredes.some(p => p[0] === x && p[1] === y);
    }

    // Crear el laberinto
    for (let i = 0; i < laberinto.alto; i++) {
      for (let j = 0; j < laberinto.ancho; j++) {
        let material;
        if (laberinto.inicio[0] === i && laberinto.inicio[1] === j) {
          material = materialInicio;
        } else if (laberinto.fin[0] === i && laberinto.fin[1] === j) {
          material = materialFin;
        } else if (esPared(i, j)) {
          material = materialPared;
        } else {
          // Si quieres que también haya un piso en los espacios libres
          material = materialPiso;
        }

        

        // Crear cubo
        const geometry = new THREE.BoxGeometry(tamañoCubo, tamañoCubo, tamañoCubo);
        const cube = new THREE.Mesh(geometry, material);

        // Posicionar cubo: en X y Y, Z es 0
        cube.position.x = j * tamañoCubo;
        cube.position.y = -i * tamañoCubo; // Para que (0,0) esté arriba a la izquierda
        cube.position.z = 0;

        scene.add(cube);
        cubos.push(cube);
      }
    }

    

    // Posicionar cámara para ver el laberinto
    camera.position.set(laberinto.ancho / 2, -laberinto.alto / 2, 10);
    camera.lookAt(laberinto.ancho / 2, -laberinto.alto / 2, 0);

    function render() {
      requestAnimationFrame(render);
      renderer.render(scene, camera);
    }
    render();

    // Para manejar redimensionamiento
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });

    function irLaberinto() {
      window.location.href = '../index.html';
    }


    function loginAdmin() {
        Swal.fire({
            title: 'Inicio de Sesión',
            html:
            '<input id="usuario" class="swal2-input" placeholder="Usuario">' +
            '<input id="password" type="password" class="swal2-input" placeholder="Contraseña">',
            confirmButtonText: 'Ingresar',
            focusConfirm: false,
            scrollbarPadding: false, // Para que el fondo no se mueva
            preConfirm: () => {
            const usuario = document.getElementById('usuario').value;
            const password = document.getElementById('password').value;

            if (usuario === 'ia1' && password === '2025') {
                Swal.fire({
                title: '¡Bienvenido!',
                text: 'Redirigiendo al panel de administrador...',
                icon: 'success',
                scrollbarPadding: false,
                timer: 1500, // tiempo antes de redirigir
                showConfirmButton: false
                }).then(() => {
                window.location.href = './admin/index.html'; // Redirige a admin.html
                });
            } else {
                Swal.fire({
                title: 'Error',
                text: 'Usuario o contraseña incorrectos.',
                icon: 'error',
                scrollbarPadding: false
                });
            }
            }
        });
    }

  </script>


</body>
</html>
